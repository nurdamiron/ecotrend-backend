FROM node:16-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install

COPY . .
COPY tests/ ./tests/

# Make all executables in node_modules/.bin directory executable
RUN chmod +x node_modules/.bin/*
RUN chmod -R 755 ./tests/

# List test directory to debug
RUN ls -la tests/

# Use npx to run Jest with explicit test path
CMD ["sh", "-c", "sleep 15 && npx jest --passWithNoTests"]
